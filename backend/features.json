{
  "version": "1.5.0",
  "description": "SPY 0DTE Level Signal Features for ML Training - Phase 3 Vectorized Pipeline",
  "output_path": "data/lake/gold/research/signals_vectorized.parquet",
  "label_column": "outcome",
  "label_values": ["BREAK", "BOUNCE"],
  "pipeline": "src.pipeline.vectorized_pipeline",
  "features": {
    "identity": {
      "description": "Signal identification fields",
      "columns": {
        "event_id": {
          "dtype": "string",
          "description": "Unique signal identifier (UUID)",
          "example": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
        },
        "ts_ns": {
          "dtype": "int64",
          "description": "Event timestamp in Unix nanoseconds UTC",
          "example": 1765843200000000000
        },
        "confirm_ts_ns": {
          "dtype": "float64",
          "description": "Confirmation timestamp (t1 = t0 + 240s = 4 minutes) in Unix nanoseconds UTC",
          "example": 1765843440000000000
        },
        "date": {
          "dtype": "string",
          "description": "Trading date (YYYY-MM-DD)",
          "example": "2025-12-17"
        },
        "symbol": {
          "dtype": "string",
          "description": "Underlying symbol (always SPY)",
          "example": "SPY"
        }
      }
    },
    "level": {
      "description": "Price level characteristics",
      "columns": {
        "spot": {
          "dtype": "float64",
          "description": "Current SPY spot price at signal time",
          "example": 684.50
        },
        "level_price": {
          "dtype": "float64",
          "description": "Price of the level being tested (strike at $1 intervals)",
          "example": 685.00
        },
        "level_kind": {
          "dtype": "int8",
          "description": "Integer code for level type",
          "mapping": {
            "0": "PM_HIGH",
            "1": "PM_LOW",
            "2": "OR_HIGH",
            "3": "OR_LOW",
            "4": "SESSION_HIGH",
            "5": "SESSION_LOW",
            "6": "SMA_200",
            "7": "VWAP",
            "8": "ROUND",
            "9": "STRIKE",
            "10": "CALL_WALL",
            "11": "PUT_WALL",
            "12": "SMA_400"
          },
          "example": 8
        },
        "level_kind_name": {
          "dtype": "string",
          "description": "Human-readable level type name",
          "values": ["PM_HIGH", "PM_LOW", "OR_HIGH", "OR_LOW", "SESSION_HIGH", "SESSION_LOW", "SMA_200", "VWAP", "ROUND", "STRIKE", "CALL_WALL", "PUT_WALL", "SMA_400"],
          "example": "ROUND"
        },
        "direction": {
          "dtype": "string",
          "description": "Direction of approach to level",
          "values": ["UP", "DOWN"],
          "example": "UP"
        },
        "direction_sign": {
          "dtype": "int8",
          "description": "Direction sign (UP=1, DOWN=-1)",
          "example": 1
        },
        "distance": {
          "dtype": "float64",
          "description": "Distance from spot to level in dollars (filtered to <= $0.50)",
          "example": 0.20
        },
        "distance_signed": {
          "dtype": "float64",
          "description": "Signed distance from spot to level (level_price - spot)",
          "example": -0.20
        },
        "atr": {
          "dtype": "float64",
          "description": "ATR (1-min bars) at touch timestamp for normalization",
          "example": 0.42
        },
        "distance_atr": {
          "dtype": "float64",
          "description": "ATR-normalized distance from spot to level",
          "example": 0.48
        },
        "distance_pct": {
          "dtype": "float64",
          "description": "Spot-normalized distance from spot to level",
          "example": 0.00029
        },
        "distance_signed_atr": {
          "dtype": "float64",
          "description": "ATR-normalized signed distance from spot to level",
          "example": -0.48
        },
        "distance_signed_pct": {
          "dtype": "float64",
          "description": "Spot-normalized signed distance from spot to level",
          "example": -0.00029
        },
        "level_price_pct": {
          "dtype": "float64",
          "description": "Level price expressed as percent difference from spot",
          "example": -0.00029
        }
      }
    },
    "context": {
      "description": "Market context and timing features",
      "columns": {
        "is_first_15m": {
          "dtype": "bool",
          "description": "Whether event occurred in first 15 minutes of trading (09:30-09:45 ET). High volatility period.",
          "example": false
        },
        "dist_to_pm_high": {
          "dtype": "float64",
          "description": "Signed distance from target level to pre-market high (level_price - PM high)",
          "example": 0.15
        },
        "dist_to_pm_low": {
          "dtype": "float64",
          "description": "Signed distance from target level to pre-market low (level_price - PM low)",
          "example": -0.40
        },
        "dist_to_pm_high_atr": {
          "dtype": "float64",
          "description": "ATR-normalized distance from target level to pre-market high",
          "example": 0.35
        },
        "dist_to_pm_high_pct": {
          "dtype": "float64",
          "description": "Spot-normalized distance from target level to pre-market high",
          "example": 0.0005
        },
        "dist_to_pm_low_atr": {
          "dtype": "float64",
          "description": "ATR-normalized distance from target level to pre-market low",
          "example": -0.45
        },
        "dist_to_pm_low_pct": {
          "dtype": "float64",
          "description": "Spot-normalized distance from target level to pre-market low",
          "example": -0.0006
        }
      }
    },
    "mean_reversion": {
      "description": "SMA-based mean reversion context (2-minute bars)",
      "columns": {
        "sma_200": {
          "dtype": "float64",
          "description": "SMA-200 value at event time (2-min bars)",
          "example": 684.25
        },
        "sma_400": {
          "dtype": "float64",
          "description": "SMA-400 value at event time (2-min bars)",
          "example": 682.90
        },
        "dist_to_sma_200": {
          "dtype": "float64",
          "description": "Signed distance from target level to SMA-200 (level_price - SMA)",
          "example": 0.25
        },
        "dist_to_sma_400": {
          "dtype": "float64",
          "description": "Signed distance from target level to SMA-400 (level_price - SMA)",
          "example": 0.80
        },
        "dist_to_sma_200_atr": {
          "dtype": "float64",
          "description": "ATR-normalized distance from target level to SMA-200",
          "example": 0.60
        },
        "dist_to_sma_200_pct": {
          "dtype": "float64",
          "description": "Spot-normalized distance from target level to SMA-200",
          "example": 0.0004
        },
        "dist_to_sma_400_atr": {
          "dtype": "float64",
          "description": "ATR-normalized distance from target level to SMA-400",
          "example": 0.80
        },
        "dist_to_sma_400_pct": {
          "dtype": "float64",
          "description": "Spot-normalized distance from target level to SMA-400",
          "example": 0.0006
        },
        "sma_200_slope": {
          "dtype": "float64",
          "description": "SMA-200 slope in $/min over rolling window",
          "example": 0.02
        },
        "sma_400_slope": {
          "dtype": "float64",
          "description": "SMA-400 slope in $/min over rolling window",
          "example": 0.01
        },
        "sma_200_slope_5bar": {
          "dtype": "float64",
          "description": "SMA-200 slope in $/min over last 5x2min bars",
          "example": 0.03
        },
        "sma_400_slope_5bar": {
          "dtype": "float64",
          "description": "SMA-400 slope in $/min over last 5x2min bars",
          "example": 0.02
        },
        "sma_spread": {
          "dtype": "float64",
          "description": "SMA-200 minus SMA-400 (trend regime proxy)",
          "example": 1.35
        },
        "mean_reversion_pressure_200": {
          "dtype": "float64",
          "description": "Distance to SMA-200 normalized by intraday volatility",
          "example": 1.20
        },
        "mean_reversion_pressure_400": {
          "dtype": "float64",
          "description": "Distance to SMA-400 normalized by intraday volatility",
          "example": 1.80
        },
        "mean_reversion_velocity_200": {
          "dtype": "float64",
          "description": "Change in distance to SMA-200 per minute",
          "example": -0.03
        },
        "mean_reversion_velocity_400": {
          "dtype": "float64",
          "description": "Change in distance to SMA-400 per minute",
          "example": -0.02
        }
      }
    },
    "confluence": {
      "description": "Confluence metrics across nearby key levels",
      "columns": {
        "confluence_count": {
          "dtype": "int32",
          "description": "Number of key levels within confluence band",
          "example": 2
        },
        "confluence_weighted_score": {
          "dtype": "float64",
          "description": "Weighted confluence score with distance decay",
          "example": 1.65
        },
        "confluence_min_distance": {
          "dtype": "float64",
          "description": "Minimum distance to a secondary key level",
          "example": 0.06
        },
        "confluence_min_distance_atr": {
          "dtype": "float64",
          "description": "ATR-normalized minimum distance to a secondary key level",
          "example": 0.15
        },
        "confluence_min_distance_pct": {
          "dtype": "float64",
          "description": "Spot-normalized minimum distance to a secondary key level",
          "example": 0.0002
        },
        "confluence_pressure": {
          "dtype": "float64",
          "description": "Normalized confluence strength indicator",
          "example": 0.42
        },
        "confluence_alignment": {
          "dtype": "int8",
          "description": "Alignment of stacked levels with approach direction (-1, 0, +1)",
          "example": 1
        }
      }
    },
    "barrier_physics": {
      "description": "Order book liquidity dynamics (ES futures MBP-10)",
      "source": "vectorized_engines.compute_barrier_metrics_batch",
      "methodology": {
        "es_spy_conversion": "ES price = SPY price * 10 (SPY $685 = ES $6850)",
        "zone_definition": "+-8 ES ticks around SPY strike ($1 = $10 ES = 40 ticks). Zone = +-$2 ES = +-$0.20 SPY",
        "forward_window": "240 seconds (4 minutes) from touch timestamp for confirmation window"
      },
      "columns": {
        "barrier_state": {
          "dtype": "string",
          "description": "Classified liquidity state at level",
          "values": ["VACUUM", "WALL", "ABSORPTION", "CONSUMED", "WEAK", "NEUTRAL"],
          "physics": {
            "VACUUM": "Liquidity pulled away without fills - easy break expected",
            "WALL": "Liquidity actively replenishing despite fills - likely reject",
            "ABSORPTION": "Large orders absorbing flow, depth stable",
            "CONSUMED": "Defending liquidity was filled (not pulled) - contested",
            "WEAK": "Minimal liquidity present at level",
            "NEUTRAL": "No significant liquidity signal"
          },
          "example": "WALL"
        },
        "barrier_delta_liq": {
          "dtype": "float64",
          "description": "Net change in defending liquidity (ES contracts). Negative = liquidity leaving.",
          "example": -150.0
        },
        "barrier_delta_liq_nonzero": {
          "dtype": "int8",
          "description": "Indicator that barrier_delta_liq is non-zero",
          "example": 1
        },
        "barrier_delta_liq_log": {
          "dtype": "float64",
          "description": "Signed log transform of barrier_delta_liq",
          "example": -5.02
        },
        "barrier_replenishment_ratio": {
          "dtype": "float64",
          "description": "Ratio of added to removed liquidity. >1.5 = WALL, <0.3 = VACUUM.",
          "example": 1.8
        },
        "wall_ratio": {
          "dtype": "float64",
          "description": "Ratio of defending liquidity to baseline. Detects unusual concentration.",
          "example": 2.1
        },
        "wall_ratio_nonzero": {
          "dtype": "int8",
          "description": "Indicator that wall_ratio is non-zero",
          "example": 0
        },
        "wall_ratio_log": {
          "dtype": "float64",
          "description": "Signed log transform of wall_ratio",
          "example": 1.13
        }
      }
    },
    "tape_physics": {
      "description": "Trade flow momentum (ES futures time & sales)",
      "source": "vectorized_engines.compute_tape_metrics_batch",
      "methodology": {
        "price_band": "$0.50 SPY around level ($5 ES)",
        "forward_window": "60 seconds from touch timestamp"
      },
      "columns": {
        "tape_imbalance": {
          "dtype": "float64",
          "description": "Buy/sell imbalance in price band around level. Range [-1, 1]. Positive = buy pressure.",
          "example": 0.35
        },
        "tape_buy_vol": {
          "dtype": "int64",
          "description": "Buy volume (contracts) in price band during window",
          "example": 1250
        },
        "tape_sell_vol": {
          "dtype": "int64",
          "description": "Sell volume (contracts) in price band during window",
          "example": 980
        },
        "tape_velocity": {
          "dtype": "float64",
          "description": "Trade arrival rate (trades per second) in window",
          "example": 45.2
        },
        "sweep_detected": {
          "dtype": "bool",
          "description": "Whether a sweep (rapid multi-level execution) was detected",
          "example": false
        }
      }
    },
    "fuel_physics": {
      "description": "Dealer gamma hedging dynamics (SPY 0DTE options)",
      "source": "vectorized_engines.compute_fuel_metrics_batch",
      "methodology": {
        "greeks": "Black-Scholes model with real-time IV estimation (vectorized numpy)",
        "aggressor_inference": "Tick Rule (uptick=BUY, downtick=SELL)",
        "gamma_flow": "Customer trade direction * size * gamma * 100 (contract multiplier)"
      },
      "columns": {
        "gamma_exposure": {
          "dtype": "float64",
          "description": "Net dealer gamma exposure at level. Negative = dealers short gamma (must chase). Positive = dealers long gamma (will fade).",
          "example": 31452.29
        },
        "fuel_effect": {
          "dtype": "string",
          "description": "Classified gamma effect on price movement",
          "values": ["AMPLIFY", "DAMPEN", "NEUTRAL"],
          "physics": {
            "AMPLIFY": "Dealers short gamma - will chase moves, accelerating breakouts",
            "DAMPEN": "Dealers long gamma - will fade moves, supporting mean reversion",
            "NEUTRAL": "No significant gamma imbalance"
          },
          "example": "DAMPEN"
        },
        "gamma_bucket": {
          "dtype": "string",
          "description": "Gamma regime bucket for retrieval filters",
          "values": ["SHORT_GAMMA", "LONG_GAMMA", "UNKNOWN"],
          "example": "LONG_GAMMA"
        }
      }
    },
    "dealer_velocity": {
      "description": "Dealer mechanics velocity features from option trade flow",
      "columns": {
        "gamma_flow_velocity": {
          "dtype": "float64",
          "description": "Net dealer gamma flow per minute in recent window near level",
          "example": -8200.0
        },
        "gamma_flow_impulse": {
          "dtype": "float64",
          "description": "Short-term gamma flow deviation vs baseline rate",
          "example": 0.45
        },
        "gamma_flow_accel_1m": {
          "dtype": "float64",
          "description": "Change in 1-minute dealer gamma flow velocity",
          "example": 1400.0
        },
        "gamma_flow_accel_3m": {
          "dtype": "float64",
          "description": "Change in 3-minute dealer gamma flow velocity",
          "example": 600.0
        },
        "dealer_pressure": {
          "dtype": "float64",
          "description": "Normalized dealer mechanics pressure indicator",
          "example": 0.62
        },
        "dealer_pressure_accel": {
          "dtype": "float64",
          "description": "Normalized dealer pressure acceleration (1-minute window)",
          "example": 0.12
        }
      }
    },
    "pressure_indicators": {
      "description": "Continuous pressure indicators used by sequence models",
      "columns": {
        "liquidity_pressure": {
          "dtype": "float64",
          "description": "Normalized liquidity pressure indicator",
          "example": 0.35
        },
        "tape_pressure": {
          "dtype": "float64",
          "description": "Normalized tape momentum indicator",
          "example": 0.28
        },
        "gamma_pressure": {
          "dtype": "float64",
          "description": "Normalized gamma pressure indicator",
          "example": 0.41
        },
        "gamma_pressure_accel": {
          "dtype": "float64",
          "description": "Normalized gamma pressure acceleration indicator",
          "example": 0.18
        },
        "reversion_pressure": {
          "dtype": "float64",
          "description": "Normalized mean reversion pressure indicator",
          "example": -0.22
        },
        "net_break_pressure": {
          "dtype": "float64",
          "description": "Composite break/bounce pressure indicator",
          "example": 0.30
        }
      }
    },
    "approach_context": {
      "description": "Backward-looking context features capturing how price approached the level",
      "source": "compute_approach_context_vectorized",
      "methodology": {
        "lookback_window": "10 minutes before touch timestamp",
        "purpose": "Critical ML features - a fast aggressive approach behaves differently than a slow grind"
      },
      "columns": {
        "approach_velocity": {
          "dtype": "float64",
          "description": "Price change per minute over lookback window ($/min). Positive = moving toward level.",
          "example": 0.15
        },
        "approach_bars": {
          "dtype": "int32",
          "description": "Number of consecutive 1-min bars moving toward level before touch",
          "example": 4
        },
        "approach_distance": {
          "dtype": "float64",
          "description": "Total price distance traveled toward level in lookback window",
          "example": 1.50
        },
        "approach_distance_atr": {
          "dtype": "float64",
          "description": "ATR-normalized approach distance",
          "example": 3.20
        },
        "approach_distance_pct": {
          "dtype": "float64",
          "description": "Spot-normalized approach distance",
          "example": 0.0023
        },
        "prior_touches": {
          "dtype": "int32",
          "description": "Count of previous touches at this exact level today",
          "example": 2
        },
        "attempt_index": {
          "dtype": "int32",
          "description": "Attempt index within touch cluster (1,2,3...)",
          "example": 2
        },
        "attempt_cluster_id": {
          "dtype": "int32",
          "description": "Cluster identifier for repeated attempts at a level",
          "example": 1
        },
        "barrier_replenishment_trend": {
          "dtype": "float64",
          "description": "Change in barrier replenishment ratio vs first attempt",
          "example": -0.4
        },
        "barrier_delta_liq_trend": {
          "dtype": "float64",
          "description": "Change in barrier delta liquidity vs first attempt",
          "example": -120.0
        },
        "tape_velocity_trend": {
          "dtype": "float64",
          "description": "Change in tape velocity vs first attempt",
          "example": 0.12
        },
        "tape_imbalance_trend": {
          "dtype": "float64",
          "description": "Change in tape imbalance vs first attempt",
          "example": -0.18
        },
        "bars_since_open": {
          "dtype": "int32",
          "description": "Number of bars since market open - session timing context",
          "example": 120
        }
      }
    },
    "outcome": {
      "description": "Ground truth label for supervised learning",
      "methodology": {
        "threshold": "$2.00 (2 strikes) - meaningful move for options trading",
        "time_to_thresholds": "$1.00 and $2.00 for time-to-threshold metrics",
        "lookforward": "8 minutes anchored at confirmation time t1 (covers full outcome determination window)",
        "note": "Must move 2 strikes to be actionable for SPY options",
        "missing_data_policy": "If the lookforward window is incomplete, outcome is UNDEFINED and forward metrics are NaN"
      },
      "columns": {
        "outcome": {
          "dtype": "string",
          "description": "What happened after the level touch",
          "values": ["BREAK", "BOUNCE", "CHOP", "UNDEFINED"],
          "labeling": {
            "BREAK": "First $2.00 move in approach direction relative to level price L after t1",
            "BOUNCE": "First $2.00 move opposite the approach direction relative to level price L after t1",
            "CHOP": "No $2.00 move in either direction relative to level price L after t1",
            "UNDEFINED": "Insufficient forward window to label outcome"
          },
          "example": "BOUNCE"
        },
        "future_price_5min": {
          "dtype": "float64",
          "description": "SPY price at end of forward window after confirmation time (t1)",
          "example": 681.425
        },
        "anchor_spot": {
          "dtype": "float64",
          "description": "Spot price at confirmation time t1 (bar open when aligned)",
          "example": 682.10
        },
        "tradeable_1": {
          "dtype": "int8",
          "description": "Reached $1.00 in either direction within forward window",
          "example": 1
        },
        "tradeable_2": {
          "dtype": "int8",
          "description": "Reached $2.00 in either direction within forward window",
          "example": 0
        },
        "excursion_max": {
          "dtype": "float64",
          "description": "Maximum excursion in approach direction relative to level price L",
          "example": 2.50
        },
        "excursion_min": {
          "dtype": "float64",
          "description": "Maximum excursion opposite approach direction relative to level price L",
          "example": 0.80
        },
        "strength_signed": {
          "dtype": "float64",
          "description": "Signed strength: break-direction excursion minus opposite (relative to level price L)",
          "example": 1.70
        },
        "strength_abs": {
          "dtype": "float64",
          "description": "Absolute max excursion in either direction relative to level price L",
          "example": 2.10
        },
        "time_to_threshold_1": {
          "dtype": "float64",
          "description": "Seconds to first $1 move in either direction relative to level price L",
          "example": 90.0
        },
        "time_to_threshold_2": {
          "dtype": "float64",
          "description": "Seconds to first $2 move in either direction relative to level price L",
          "example": 210.0
        },
        "time_to_break_1": {
          "dtype": "float64",
          "description": "Seconds to first $1 move in break direction relative to level price L",
          "example": 60.0
        },
        "time_to_bounce_1": {
          "dtype": "float64",
          "description": "Seconds to first $1 move in bounce direction relative to level price L",
          "example": 120.0
        },
        "time_to_break_2": {
          "dtype": "float64",
          "description": "Seconds to first $2 move in break direction relative to level price L",
          "example": 150.0
        },
        "time_to_bounce_2": {
          "dtype": "float64",
          "description": "Seconds to first $2 move in bounce direction relative to level price L",
          "example": 210.0
        },
        "outcome_2min": {
          "dtype": "string",
          "description": "Outcome at 2-minute confirmation (fast trades)",
          "values": ["BREAK", "BOUNCE", "CHOP", "UNDEFINED"],
          "example": "CHOP"
        },
        "outcome_4min": {
          "dtype": "string",
          "description": "Outcome at 4-minute confirmation (primary timeframe)",
          "values": ["BREAK", "BOUNCE", "CHOP", "UNDEFINED"],
          "example": "BOUNCE"
        },
        "outcome_8min": {
          "dtype": "string",
          "description": "Outcome at 8-minute confirmation (longer holds)",
          "values": ["BREAK", "BOUNCE", "CHOP", "UNDEFINED"],
          "example": "BREAK"
        },
        "excursion_max_2min": {"dtype": "float64", "description": "Max favorable excursion at 2min", "example": 1.25},
        "excursion_max_4min": {"dtype": "float64", "description": "Max favorable excursion at 4min", "example": 2.50},
        "excursion_max_8min": {"dtype": "float64", "description": "Max favorable excursion at 8min", "example": 3.75},
        "excursion_min_2min": {"dtype": "float64", "description": "Max adverse excursion at 2min", "example": 0.50},
        "excursion_min_4min": {"dtype": "float64", "description": "Max adverse excursion at 4min", "example": 0.80},
        "excursion_min_8min": {"dtype": "float64", "description": "Max adverse excursion at 8min", "example": 1.00},
        "strength_signed_2min": {"dtype": "float64", "description": "Signed strength at 2min", "example": 0.75},
        "strength_signed_4min": {"dtype": "float64", "description": "Signed strength at 4min", "example": 1.70},
        "strength_signed_8min": {"dtype": "float64", "description": "Signed strength at 8min", "example": 2.75},
        "strength_abs_2min": {"dtype": "float64", "description": "Absolute strength at 2min", "example": 1.25},
        "strength_abs_4min": {"dtype": "float64", "description": "Absolute strength at 4min", "example": 2.50},
        "strength_abs_8min": {"dtype": "float64", "description": "Absolute strength at 8min", "example": 3.75},
        "tradeable_1_2min": {"dtype": "int8", "description": "$1 reached at 2min", "example": 1},
        "tradeable_1_4min": {"dtype": "int8", "description": "$1 reached at 4min", "example": 1},
        "tradeable_1_8min": {"dtype": "int8", "description": "$1 reached at 8min", "example": 1},
        "tradeable_2_2min": {"dtype": "int8", "description": "$2 reached at 2min", "example": 0},
        "tradeable_2_4min": {"dtype": "int8", "description": "$2 reached at 4min", "example": 1},
        "tradeable_2_8min": {"dtype": "int8", "description": "$2 reached at 8min", "example": 1},
        "time_to_threshold_1_2min": {"dtype": "float64", "description": "Time to $1 from 2min confirmation", "example": 45.0},
        "time_to_threshold_1_4min": {"dtype": "float64", "description": "Time to $1 from 4min confirmation", "example": 90.0},
        "time_to_threshold_1_8min": {"dtype": "float64", "description": "Time to $1 from 8min confirmation", "example": 120.0},
        "time_to_threshold_2_2min": {"dtype": "float64", "description": "Time to $2 from 2min confirmation", "example": null},
        "time_to_threshold_2_4min": {"dtype": "float64", "description": "Time to $2 from 4min confirmation", "example": 180.0},
        "time_to_threshold_2_8min": {"dtype": "float64", "description": "Time to $2 from 8min confirmation", "example": 210.0},
        "time_to_break_1_2min": {"dtype": "float64", "description": "Time to $1 break from 2min confirmation", "example": 40.0},
        "time_to_break_1_4min": {"dtype": "float64", "description": "Time to $1 break from 4min confirmation", "example": 80.0},
        "time_to_break_1_8min": {"dtype": "float64", "description": "Time to $1 break from 8min confirmation", "example": 110.0},
        "time_to_bounce_1_2min": {"dtype": "float64", "description": "Time to $1 bounce from 2min confirmation", "example": 50.0},
        "time_to_bounce_1_4min": {"dtype": "float64", "description": "Time to $1 bounce from 4min confirmation", "example": 100.0},
        "time_to_bounce_1_8min": {"dtype": "float64", "description": "Time to $1 bounce from 8min confirmation", "example": 130.0},
        "time_to_break_2_2min": {"dtype": "float64", "description": "Time to $2 break from 2min confirmation", "example": null},
        "time_to_break_2_4min": {"dtype": "float64", "description": "Time to $2 break from 4min confirmation", "example": 160.0},
        "time_to_break_2_8min": {"dtype": "float64", "description": "Time to $2 break from 8min confirmation", "example": 200.0},
        "time_to_bounce_2_2min": {"dtype": "float64", "description": "Time to $2 bounce from 2min confirmation", "example": null},
        "time_to_bounce_2_4min": {"dtype": "float64", "description": "Time to $2 bounce from 4min confirmation", "example": 190.0},
        "time_to_bounce_2_8min": {"dtype": "float64", "description": "Time to $2 bounce from 8min confirmation", "example": 230.0},
        "confirm_ts_ns_2min": {"dtype": "float64", "description": "Confirmation timestamp at 2min", "example": 1765843320000000000},
        "confirm_ts_ns_4min": {"dtype": "float64", "description": "Confirmation timestamp at 4min", "example": 1765843440000000000},
        "confirm_ts_ns_8min": {"dtype": "float64", "description": "Confirmation timestamp at 8min", "example": 1765843680000000000},
        "anchor_spot_2min": {"dtype": "float64", "description": "Anchor price at 2min confirmation", "example": 682.10},
        "anchor_spot_4min": {"dtype": "float64", "description": "Anchor price at 4min confirmation", "example": 682.25},
        "anchor_spot_8min": {"dtype": "float64", "description": "Anchor price at 8min confirmation", "example": 682.50},
        "future_price_2min": {"dtype": "float64", "description": "Price at end of 2min forward window", "example": 681.80},
        "future_price_4min": {"dtype": "float64", "description": "Price at end of 4min forward window", "example": 680.40},
        "future_price_8min": {"dtype": "float64", "description": "Price at end of 8min forward window", "example": 679.25}
      }
    }
  },
  "statistics": {
    "generated_at": "2025-12-23",
    "total_signals": 3328,
    "date_range": ["2025-12-16", "2025-12-19"],
    "dates_processed": 4,
    "quality_filter": "distance <= $0.25 (MONITOR_BAND) - critical decision zone",
    "outcome_distribution": {
      "BREAK": 0.505,
      "BOUNCE": 0.444,
      "CHOP": 0.049,
      "UNDEFINED": 0.002
    },
    "barrier_state_distribution": {
      "NEUTRAL": 3180,
      "WEAK": 52,
      "WALL": 53,
      "VACUUM": 43
    },
    "fuel_effect_distribution": {
      "DAMPEN": 0.724,
      "AMPLIFY": 0.095,
      "NEUTRAL": 0.181
    },
    "feature_coverage": {
      "gamma_exposure": {
        "non_null": 1.0,
        "non_zero": 1.0,
        "mean": 33434.27,
        "min": -204008.67,
        "max": 140990.23
      },
      "tape_imbalance": {
        "non_null": 1.0,
        "non_zero": 0.989
      },
      "tape_velocity": {
        "non_null": 1.0,
        "non_zero": 1.0
      },
      "wall_ratio": {
        "non_null": 1.0,
        "non_zero": 0.033,
        "note": "Expected sparse - only detects unusual liquidity concentration at strikes"
      },
      "barrier_delta_liq": {
        "non_null": 1.0,
        "non_zero": 0.048
      },
      "spot": {
        "non_null": 1.0,
        "non_zero": 1.0,
        "mean": 683.02,
        "min": 672.18,
        "max": 690.30
      },
      "distance": {
        "non_null": 1.0,
        "non_zero": 0.951,
        "mean": 0.116,
        "min": 0.0,
        "max": 0.25
      },
      "approach_velocity": {
        "non_null": 1.0,
        "non_zero": 0.979,
        "mean": -0.029,
        "min": -1.12,
        "max": 0.71
      },
      "approach_bars": {
        "non_null": 1.0,
        "non_zero": 0.418,
        "mean": 0.673,
        "min": 0,
        "max": 7
      },
      "approach_distance": {
        "non_null": 1.0,
        "non_zero": 0.979,
        "mean": 1.80,
        "min": 0.0,
        "max": 7.10
      },
      "prior_touches": {
        "non_null": 1.0,
        "non_zero": 0.976,
        "mean": 39.03,
        "min": 0,
        "max": 161
      },
      "bars_since_open": {
        "non_null": 1.0,
        "non_zero": 1.0,
        "mean": 765.82,
        "min": 0,
        "max": 1439
      }
    }
  },
  "data_sources": {
    "es_futures": {
      "provider": "Databento",
      "format": "DBN (trades + MBP-10)",
      "conversion": "ES price / 10 = SPY equivalent",
      "fields": ["price", "size", "aggressor", "depth levels 1-10"]
    },
    "spy_options": {
      "provider": "Polygon.io",
      "format": "S3 flat files (CSV.gz)",
      "endpoint": "https://files.polygon.io",
      "bucket": "flatfiles",
      "path": "us_options_opra/trades_v1/YYYY/MM/YYYY-MM-DD.csv.gz",
      "fields": ["ticker", "price", "size", "sip_timestamp"]
    }
  },
  "methodology": {
    "greeks_calculation": "Black-Scholes-Merton with vectorized NumPy",
    "aggressor_inference": "Tick Rule: compare trade price to previous trade",
    "0dte_filter": "All option processing restricted to same-day expiration",
    "es_spy_conversion": "ES_price = SPY_price * 10 (ES trades at 10x SPY notional)",
    "barrier_zone": "+-8 ES ticks (+-$2 ES = +-$0.20 SPY) around strike-aligned levels",
    "touch_detection": "OHLCV high/low crosses level price within TOUCH_BAND (CONFIG.TOUCH_BAND)",
    "quality_filter": "Only signals where close price within $0.25 of level (critical zone)",
    "outcome_threshold": "Move >=$2.00 (2 strikes) in forward window for BREAK/BOUNCE - meaningful for options",
    "lookback_context": "10 minutes backward for approach velocity, bars, distance",
    "time_windows": "Forward-looking from bar START (240s confirmation, 8min total forward window)",
    "sma_warmup": "SMA-200/400 computed on 2-min bars with up to CONFIG.SMA_WARMUP_DAYS prior sessions prepended when available"
  }
}
