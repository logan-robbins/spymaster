target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
knobs={"horizon": 3, "k_raw": 500, "k_values": [5, 10, 20, 50, 100], "normalization": "robust_l2", "similarity_metric": "inner_product", "tau": 0.03, "tod_minutes": 30}
Table A — Best k per model
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
| target_id                               | split_id         | level_id   | approach_dir   | model     |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:-----------------|:-----------|:---------------|:----------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | base_rate |   5 | 0.5      | 0.064556 | 0.003514 |          0.951774 |   0.252057 | 2754 | min_log_loss|max_auc |                 0        |                      0        |                             0        |                 0        |               -0.015176 |                    -0.486311 |                           -0.079026 |               -0.091548 |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | knn       | 100 | 0.821062 | 0.071079 | 0.052904 |          3.43087  |   0.257306 | 2754 | min_log_loss|max_auc |                 0.321062 |                      0.005249 |                             2.4791   |                 0.04939  |                0.322189 |                    -0.006255 |                            2.32056  |                0.036611 |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | logit     |   5 | 0.825607 | 0.09821  | 0.088389 |          3.48059  |   0.406583 | 2754 | min_log_loss|max_auc |                 0.325607 |                      0.154527 |                             2.52882  |                 0.084875 |                0.310432 |                    -0.331785 |                            2.44979  |               -0.006673 |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | null_knn  | 100 | 0.498873 | 0.065554 | 0.016293 |          1.11031  |   0.263561 | 2754 | min_log_loss         |                -0.001127 |                      0.011504 |                             0.15854  |                 0.012779 |                0        |                     0        |                            0        |                0        |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | null_knn  |   5 | 0.515176 | 0.076993 | 0.095062 |          1.0308   |   0.738368 | 2754 | max_auc              |                 0.015176 |                      0.486311 |                             0.079026 |                 0.091548 |                0        |                     0        |                            0        |                0        |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | tod_rate  |   5 | 0.505442 | 0.064818 | 0.006618 |          1.20996  |   0.253927 | 2754 | min_log_loss|max_auc |                 0.005442 |                      0.00187  |                             0.258185 |                 0.003104 |               -0.009734 |                    -0.484441 |                            0.179159 |               -0.088444 |

Table B — Leaderboard by delta_auc vs null_knn
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
Top 10
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
| target_id                               | split_id         | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:-----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | knn     | 100 | 0.821062 | 0.071079 | 0.052904 |           3.43087 |   0.257306 | 2754 | max_auc|min_log_loss |                 0.321062 |                      0.005249 |                               2.4791 |                  0.04939 |                0.322189 |                    -0.006255 |                             2.32056 |                0.036611 |

Bottom 10
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
| target_id                               | split_id         | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:-----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | knn     | 100 | 0.821062 | 0.071079 | 0.052904 |           3.43087 |   0.257306 | 2754 | max_auc|min_log_loss |                 0.321062 |                      0.005249 |                               2.4791 |                  0.04939 |                0.322189 |                    -0.006255 |                             2.32056 |                0.036611 |

Shape diagnostics
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
base_rate=0.072868 n=2754
| metric          |      min |   median |      max |
|:----------------|---------:|---------:|---------:|
| auc             | 0.771038 | 0.817327 | 0.821062 |
| log_loss        | 0.257306 | 0.281946 | 0.42448  |
| ece             | 0.052904 | 0.056328 | 0.069773 |
| lift_top_decile | 3.33143  | 3.38115  | 3.43087  |

Pareto set (AUC high, log_loss low, ECE low)
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
| target_id                               | split_id         | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n |
|:----------------------------------------|:-----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_2025-12-01 | pm_high    | approach_up    | knn     | 100 | 0.821062 | 0.071079 | 0.052904 |           3.43087 |   0.257306 | 2754 |

Table C — Calibration fixes
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/split_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=8a91a99f997da3942500b56b444b16651c04b0236a1ac0a6a28cb5b2800897ed
|   k | method    |   log_loss |      ece |      auc |
|----:|:----------|-----------:|---------:|---------:|
| 100 | knn_raw   |   0.257306 | 0.052904 | 0.821062 |
| 100 | knn_temp  |   0.242288 | 0.0737   | 0.821062 |
| 100 | knn_platt |   0.209692 | 0.022871 | 0.821062 |
| 100 | knn_iso   |   0.208647 | 0.014372 | 0.817306 |