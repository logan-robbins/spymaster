target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
knobs={"horizon": 3, "k_raw": 500, "k_values": [5, 10, 20, 50, 100], "normalization": "robust_l2", "similarity_metric": "inner_product", "tau": 0.03, "tod_minutes": 30}
Table A — Best k per model
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
| target_id                               | split_id        | level_id   | approach_dir   | model     |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:----------------|:-----------|:---------------|:----------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | base_rate |   5 | 0.5      | 0.064556 | 0.003514 |          0.951774 |   0.252057 | 2754 | min_log_loss|max_auc |                 0        |                      0        |                             0        |                 0        |               -0.015176 |                    -0.486311 |                           -0.079026 |               -0.091548 |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | knn       | 100 | 0.829975 | 0.069034 | 0.046295 |          3.58004  |   0.24787  | 2754 | min_log_loss|max_auc |                 0.329975 |                     -0.004186 |                             2.62827  |                 0.04278  |                0.331101 |                    -0.015691 |                            2.46972  |                0.030002 |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | logit     |   5 | 0.825607 | 0.09821  | 0.088389 |          3.48059  |   0.406583 | 2754 | min_log_loss|max_auc |                 0.325607 |                      0.154527 |                             2.52882  |                 0.084875 |                0.310432 |                    -0.331785 |                            2.44979  |               -0.006673 |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | null_knn  | 100 | 0.498873 | 0.065554 | 0.016293 |          1.11031  |   0.263561 | 2754 | min_log_loss         |                -0.001127 |                      0.011504 |                             0.15854  |                 0.012779 |                0        |                     0        |                            0        |                0        |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | null_knn  |   5 | 0.515176 | 0.076993 | 0.095062 |          1.0308   |   0.738368 | 2754 | max_auc              |                 0.015176 |                      0.486311 |                             0.079026 |                 0.091548 |                0        |                     0        |                            0        |                0        |
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | tod_rate  |   5 | 0.505442 | 0.064818 | 0.006618 |          1.20996  |   0.253927 | 2754 | min_log_loss|max_auc |                 0.005442 |                      0.00187  |                             0.258185 |                 0.003104 |               -0.009734 |                    -0.484441 |                            0.179159 |               -0.088444 |

Table B — Leaderboard by delta_auc vs null_knn
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
Top 10
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
| target_id                               | split_id        | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | knn     | 100 | 0.829975 | 0.069034 | 0.046295 |           3.58004 |    0.24787 | 2754 | max_auc|min_log_loss |                 0.329975 |                     -0.004186 |                              2.62827 |                  0.04278 |                0.331101 |                    -0.015691 |                             2.46972 |                0.030002 |

Bottom 10
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
| target_id                               | split_id        | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | knn     | 100 | 0.829975 | 0.069034 | 0.046295 |           3.58004 |    0.24787 | 2754 | max_auc|min_log_loss |                 0.329975 |                     -0.004186 |                              2.62827 |                  0.04278 |                0.331101 |                    -0.015691 |                             2.46972 |                0.030002 |

Shape diagnostics
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
base_rate=0.072868 n=2754
| metric          |      min |   median |      max |
|:----------------|---------:|---------:|---------:|
| auc             | 0.777375 | 0.819379 | 0.829975 |
| log_loss        | 0.24787  | 0.285212 | 0.414772 |
| ece             | 0.046295 | 0.048561 | 0.062684 |
| lift_top_decile | 3.48059  | 3.53032  | 3.58004  |

Pareto set (AUC high, log_loss low, ECE low)
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
| target_id                               | split_id        | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n |
|:----------------------------------------|:----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|
| true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | walk_2025-12-01 | pm_high    | approach_up    | knn     | 100 | 0.829975 | 0.069034 | 0.046295 |           3.58004 |    0.24787 | 2754 |

Table C — Calibration fixes
target_id=true_outcome_h3:BREAK_UP_vs_REJECT_DOWN | split_id=walk_2025-12-01 | level_id=pm_high | approach_dir=approach_up | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_up/walk_2025-12-01/index/norm_stats.json:93687c01a742454cc3916a5d618018278f2aaba99c93f3e549b337e194349f62 | faiss_index_hash=7fd8d6e2ab5b3274b42566ace313c4f45326dcee89bf85d9f79d956b99798f64
|   k | method    |   log_loss |      ece |      auc |
|----:|:----------|-----------:|---------:|---------:|
| 100 | knn_raw   |   0.24787  | 0.046295 | 0.829975 |
| 100 | knn_temp  |   0.23055  | 0.0616   | 0.829975 |
| 100 | knn_platt |   0.206327 | 0.019541 | 0.829975 |
| 100 | knn_iso   |   0.206334 | 0.017534 | 0.825961 |