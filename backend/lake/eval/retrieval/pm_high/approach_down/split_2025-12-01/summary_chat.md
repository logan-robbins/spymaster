target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
knobs={"horizon": 3, "k_raw": 500, "k_values": [5, 10, 20, 50, 100], "normalization": "robust_l2", "similarity_metric": "inner_product", "tau": 0.03, "tod_minutes": 30}
Table A — Best k per model
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
| target_id                               | split_id         | level_id   | approach_dir   | model     |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n | selection            |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:-----------------|:-----------|:---------------|:----------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|:---------------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | base_rate |   5 | 0.5      | 0.070561 | 0.011353 |           1.17494 |   0.27051  | 2269 | min_log_loss|max_auc |                 0        |                      0        |                             0        |                 0        |                0.04434  |                    -0.675732 |                            0.369187 |               -0.098123 |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | knn       | 100 | 0.834345 | 0.069126 | 0.049217 |           4.27682 |   0.268924 | 2269 | min_log_loss         |                 0.334345 |                     -0.001587 |                             3.10187  |                 0.037864 |                0.352605 |                    -0.024881 |                            3.09142  |                0.026061 |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | knn       |  50 | 0.835226 | 0.06925  | 0.049667 |           4.27682 |   0.272635 | 2269 | max_auc              |                 0.335226 |                      0.002125 |                             3.10187  |                 0.038315 |                0.369068 |                    -0.0921   |                            3.17609  |                0.013431 |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | logit     |   5 | 0.785634 | 0.099067 | 0.092052 |           3.25853 |   0.513591 | 2269 | min_log_loss|max_auc |                 0.285634 |                      0.24308  |                             2.08358  |                 0.080699 |                0.329973 |                    -0.432652 |                            2.45277  |               -0.017424 |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | null_knn  | 100 | 0.481739 | 0.071733 | 0.023156 |           1.18539 |   0.293805 | 2269 | min_log_loss         |                -0.018261 |                      0.023294 |                             0.010449 |                 0.011803 |                0        |                     0        |                            0        |                0        |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | null_knn  |  10 | 0.490153 | 0.076994 | 0.071926 |           1.30841 |   0.718341 | 2269 | max_auc              |                -0.009847 |                      0.447831 |                             0.133461 |                 0.060573 |                0        |                     0        |                            0        |                0        |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | tod_rate  |   5 | 0.495978 | 0.071402 | 0.013975 |           1.90248 |   0.282357 | 2269 | min_log_loss|max_auc |                -0.004022 |                      0.011847 |                             0.727538 |                 0.002623 |                0.040318 |                    -0.663885 |                            1.09672  |               -0.0955   |

Table B — Leaderboard by delta_auc vs null_knn
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
Top 10
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
| target_id                               | split_id         | level_id   | approach_dir   | model   |   k |      auc |   brier |      ece |   lift_top_decile |   log_loss |    n | selection   |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:-----------------|:-----------|:---------------|:--------|----:|---------:|--------:|---------:|------------------:|-----------:|-----:|:------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | knn     |  50 | 0.835226 | 0.06925 | 0.049667 |           4.27682 |   0.272635 | 2269 | max_auc     |                 0.335226 |                      0.002125 |                              3.10187 |                 0.038315 |                0.369068 |                      -0.0921 |                             3.17609 |                0.013431 |

Bottom 10
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
| target_id                               | split_id         | level_id   | approach_dir   | model   |   k |      auc |   brier |      ece |   lift_top_decile |   log_loss |    n | selection   |   delta_auc_vs_base_rate |   delta_log_loss_vs_base_rate |   delta_lift_top_decile_vs_base_rate |   delta_ece_vs_base_rate |   delta_auc_vs_null_knn |   delta_log_loss_vs_null_knn |   delta_lift_top_decile_vs_null_knn |   delta_ece_vs_null_knn |
|:----------------------------------------|:-----------------|:-----------|:---------------|:--------|----:|---------:|--------:|---------:|------------------:|-----------:|-----:|:------------|-------------------------:|------------------------------:|-------------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------------:|------------------------:|
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | knn     |  50 | 0.835226 | 0.06925 | 0.049667 |           4.27682 |   0.272635 | 2269 | max_auc     |                 0.335226 |                      0.002125 |                              3.10187 |                 0.038315 |                0.369068 |                      -0.0921 |                             3.17609 |                0.013431 |

Shape diagnostics
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
base_rate=0.064892 n=2269
| metric          |      min |   median |      max |
|:----------------|---------:|---------:|---------:|
| auc             | 0.742424 | 0.833798 | 0.835226 |
| log_loss        | 0.268924 | 0.292391 | 0.520279 |
| ece             | 0.049217 | 0.053233 | 0.064244 |
| lift_top_decile | 4.07316  | 4.27682  | 4.27682  |

Pareto set (AUC high, log_loss low, ECE low)
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
| target_id                               | split_id         | level_id   | approach_dir   | model   |   k |      auc |    brier |      ece |   lift_top_decile |   log_loss |    n |
|:----------------------------------------|:-----------------|:-----------|:---------------|:--------|----:|---------:|---------:|---------:|------------------:|-----------:|-----:|
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | knn     |  50 | 0.835226 | 0.06925  | 0.049667 |           4.27682 |   0.272635 | 2269 |
| true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_2025-12-01 | pm_high    | approach_down  | knn     | 100 | 0.834345 | 0.069126 | 0.049217 |           4.27682 |   0.268924 | 2269 |

Table C — Calibration fixes
target_id=true_outcome_h3:BREAK_DOWN_vs_REJECT_UP | split_id=split_2025-12-01 | level_id=pm_high | approach_dir=approach_down | train_range=2025-10-01:2025-12-01 | test_range=2025-12-02:2026-01-08 | norm_stats_source=lake/eval/retrieval/pm_high/approach_down/split_2025-12-01/index/norm_stats.json:1c4a74bad88eabadf01624887bd9fa3b141d3b8990e8c67cc34d4690467e962b | faiss_index_hash=f03c64d86994f84fc1c997f6298330c072e8e9336690808e8f9710b01ba0a0a1
|   k | method    |   log_loss |      ece |      auc |
|----:|:----------|-----------:|---------:|---------:|
|  50 | knn_raw   |   0.272635 | 0.049667 | 0.835226 |
|  50 | knn_temp  |   0.228623 | 0.049809 | 0.835233 |
|  50 | knn_platt |   0.216778 | 0.021058 | 0.835233 |
|  50 | knn_iso   |   0.219127 | 0.007268 | 0.828486 |
| 100 | knn_raw   |   0.268924 | 0.049217 | 0.834345 |
| 100 | knn_temp  |   0.231095 | 0.053559 | 0.834345 |
| 100 | knn_platt |   0.21809  | 0.020105 | 0.834345 |
| 100 | knn_iso   |   0.223191 | 0.009437 | 0.825247 |